<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>UatuAudit - Audit Runs</title>
    <link rel="stylesheet" href="/static/styles.css">
</head>
<body>
    <div class="container">
        <header class="dashboard-header">
            <h1>ðŸ¦‰ UatuAudit Dashboard</h1>
            <nav class="nav-menu">
                <a href="/dashboard" class="nav-link active">Runs</a>
                <a href="/portfolio" class="nav-link">Portfolio</a>
                <a href="/logout" class="nav-link">Logout</a>
            </nav>
            <div class="user-info">
                <span>ðŸ‘¤ {{ user.login if user else 'Guest' }}</span>
            </div>
        </header>

        <main class="dashboard-main">
            <div class="filters">
                <form method="GET" class="filter-form">
                    <select name="grade" class="filter-select">
                        <option value="">All Grades</option>
                        {% for grade in grades %}
                        <option value="{{ grade }}" {% if grade == grade_filter %}selected{% endif %}>{{ grade }}</option>
                        {% endfor %}
                    </select>
                    
                    <select name="kind" class="filter-select">
                        <option value="">All Types</option>
                        {% for kind in kinds %}
                        <option value="{{ kind }}" {% if kind == kind_filter %}selected{% endif %}>{{ kind }}</option>
                        {% endfor %}
                    </select>
                    
                    <input type="text" name="search" placeholder="Search contracts..." value="{{ search_query }}" class="search-input">
                    <button type="submit" class="filter-btn">Filter</button>
                </form>
            </div>

            <div class="runs-grid">
                {% if runs %}
                    {% for run in runs %}
                    <div class="run-card">
                        <div class="run-header">
                            <h3>{{ run.id }}</h3>
                            <span class="run-grade" style="background-color: {{ get_grade_color(run.grade) }}">
                                {{ run.grade }}
                            </span>
                        </div>
                        <div class="run-details">
                            <p><strong>Type:</strong> {{ run.kind }}</p>
                            <p><strong>Score:</strong> {{ "%.1f"|format(run.overall) }}</p>
                            <p><strong>Timestamp:</strong> {{ run.ts }}</p>
                        </div>
                        <div class="run-actions">
                            <a href="/run/{{ run.ts }}" class="btn btn-primary">View Details</a>
                            {% if run.has_pdf %}
                                <a href="/download/pdf/{{ run.ts }}" class="btn btn-secondary">Download PDF</a>
                            {% endif %}
                        </div>
                    </div>
                    {% endfor %}
                {% else %}
                    <div class="no-runs">
                        <h3>No audit runs found</h3>
                        <p>Run your first contract audit to see results here.</p>
                        <a href="/" class="btn btn-primary">Start Auditing</a>
                    </div>
                {% endif %}
            </div>
        </main>
    </div>
</body>
</html>
